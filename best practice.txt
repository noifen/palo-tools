# set command configuration for panos v10.1
# commands are expected to be loaded in order and run from operational mode (we switch modes at the start)
# adapted from Palo's iron skillet
# either 'search and replace' or the scripts in the tools dir can be used to create a loadable configuration

#turn on scripting mode to make things quicker
set cli scripting-mode on
configure

# management interface configuration - may be skipped if already online
set deviceconfig system dns-setting servers primary 1.1.1.2
set deviceconfig system dns-setting servers secondary 8.8.4.4

# NTP configuration
set deviceconfig system ntp-servers primary-ntp-server ntp-server-address 0.pool.ntp.org
set deviceconfig system ntp-servers secondary-ntp-server ntp-server-address 1.pool.ntp.org

# set password complexity - will not impact existing users
set mgt-config password-complexity enabled yes
set mgt-config password-complexity minimum-length 12
set mgt-config password-complexity minimum-uppercase-letters 1
set mgt-config password-complexity minimum-lowercase-letters 1
set mgt-config password-complexity minimum-numeric-letters 1
set mgt-config password-complexity minimum-special-characters 1
set mgt-config password-complexity block-username-inclusion yes
set mgt-config password-complexity password-history-count 24
set mgt-config password-complexity new-password-differs-by-characters 3

#SNMP settings - COPY ONLY ONE LINE v3 Preferred
set config devices localhost.localdomain deviceconfig system snmp-setting access-setting version v2c snmp-community-string <password>
set deviceconfig system snmp-setting access-setting version v3

# device system and settings configuration
set deviceconfig system update-schedule threats recurring every-30-mins at 17
set deviceconfig system update-schedule threats recurring every-30-mins action download-and-install
set deviceconfig system update-schedule threats recurring threshold 48
set deviceconfig system update-schedule anti-virus recurring hourly at 4
set deviceconfig system update-schedule anti-virus recurring hourly action download-and-install
set deviceconfig system update-schedule wildfire recurring real-time
set deviceconfig system update-schedule global-protect-datafile recurring hourly at 40
set deviceconfig system update-schedule global-protect-datafile recurring hourly action download-and-install
set deviceconfig system update-schedule global-protect-clientless-vpn recurring hourly at 50
set deviceconfig system update-schedule global-protect-clientless-vpn recurring hourly action download-and-install
set deviceconfig system login-banner "You have accessed a protected system. Log off immediately if you are not an authorized user."
set deviceconfig system timezone Europe/London
set deviceconfig setting ctd tcp-bypass-exceed-queue no
set deviceconfig setting ctd udp-bypass-exceed-queue no
set deviceconfig setting management enable-log-high-dp-load yes
set deviceconfig setting management api key lifetime 525600
set deviceconfig setting management max-rows-in-csv-export 1048576
set deviceconfig setting management admin-lockout failed-attempts 5
set deviceconfig setting management admin-lockout lockout-time 30
set deviceconfig setting management idle-timeout 10
set deviceconfig setting management auto-acquire-commit-lock yes
set deviceconfig setting management enable-certificate-expiration-check yes
set deviceconfig setting wildfire file-size-limit pe size-limit 16
set deviceconfig setting wildfire file-size-limit apk size-limit 30
set deviceconfig setting wildfire file-size-limit pdf size-limit 3072
set deviceconfig setting wildfire file-size-limit ms-office size-limit 16384
set deviceconfig setting wildfire file-size-limit jar size-limit 5
set deviceconfig setting wildfire file-size-limit flash size-limit 5
set deviceconfig setting wildfire file-size-limit MacOSX size-limit 10
set deviceconfig setting wildfire file-size-limit archive size-limit 50
set deviceconfig setting wildfire file-size-limit linux size-limit 50
set deviceconfig setting wildfire file-size-limit script size-limit 20
set deviceconfig setting wildfire report-benign-file yes
set deviceconfig setting wildfire report-grayware-file yes
set deviceconfig setting config rematch yes
set deviceconfig setting application notify-user yes
set deviceconfig setting application bypass-exceed-queue no
set deviceconfig setting logging log-suppression no
set deviceconfig setting tcp urgent-data clear
set deviceconfig setting tcp drop-zero-flag yes
set deviceconfig setting tcp bypass-exceed-oo-queue no
set deviceconfig setting tcp check-timestamp-option yes
set deviceconfig setting tcp strip-mptcp-option yes
set deviceconfig setting session packet-buffer-protection-latency-alert 50
set deviceconfig setting session packet-buffer-protection-latency-activate 200
set deviceconfig setting session packet-buffer-protection-latency-max-tolerate 500
set deviceconfig setting session packet-buffer-protection-latency-block-countdown 500
set deviceconfig setting session packet-buffer-protection-enable yes

#This might break things like SCCM, so use with caution
set deviceconfig setting ctd allow-http-range no

#Tags referenced in security rules
set tag Outbound comments "Outbound to the Internet"
set tag Inbound comments "Inbound from the Internet"
set tag Internal comments "Internal to Internal"
set tag PCI comments "Rules used in PCI-DSS"
set tag PCI color color14
set tag trust color color9
set tag untrust color color14
set tag "GP Remote" color color6
set tag "Guest" color color26

#File Blocking Profile
set profiles file-blocking Outbound-FB rules Alert-All application any
set profiles file-blocking Outbound-FB rules Alert-All file-type any
set profiles file-blocking Outbound-FB rules Alert-All direction both
set profiles file-blocking Outbound-FB rules Alert-All action alert
set profiles file-blocking Outbound-FB rules Block application any
set profiles file-blocking Outbound-FB rules Block file-type [ 7z bat chm class cpl dll hlp hta jar ocx pif scr torrent vbe wsf ]
set profiles file-blocking Outbound-FB rules Block direction both
set profiles file-blocking Outbound-FB rules Block action block
set profiles file-blocking Inbound-FB rules Alert-All application any
set profiles file-blocking Inbound-FB rules Alert-All file-type any
set profiles file-blocking Inbound-FB rules Alert-All direction both
set profiles file-blocking Inbound-FB rules Alert-All action alert
set profiles file-blocking Inbound-FB rules Block application any
set profiles file-blocking Inbound-FB rules Block file-type [ 7z bat chm class cpl dll hlp hta jar ocx pif scr torrent vbe wsf ]
set profiles file-blocking Inbound-FB rules Block direction both
set profiles file-blocking Inbound-FB rules Block action block
set profiles file-blocking Internal-FB rules Alert-All application any
set profiles file-blocking Internal-FB rules Alert-All file-type any
set profiles file-blocking Internal-FB rules Alert-All direction both
set profiles file-blocking Internal-FB rules Alert-All action alert
set profiles file-blocking Internal-FB rules Block application any
set profiles file-blocking Internal-FB rules Block file-type [ 7z bat chm class cpl hlp hta jar ocx pif scr torrent vbe wsf ]
set profiles file-blocking Internal-FB rules Block direction both
set profiles file-blocking Internal-FB rules Block action block
set profiles file-blocking Alert-Only-FB rules Alert-Only application any
set profiles file-blocking Alert-Only-FB rules Alert-Only file-type any
set profiles file-blocking Alert-Only-FB rules Alert-Only direction both
set profiles file-blocking Alert-Only-FB rules Alert-Only action alert

#Anti-Spyware Profile with Sinkholing
set profiles spyware Outbound-AS botnet-domains sinkhole ipv4-address sinkhole.paloaltonetworks.com
set profiles spyware Outbound-AS botnet-domains sinkhole ipv6-address 2600:5200::1
set profiles spyware Outbound-AS botnet-domains lists default-paloalto-dns packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains lists default-paloalto-dns action sinkhole
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-benign log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-benign action default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-benign packet-capture disable
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-cc log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-cc action sinkhole
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-cc packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-ddns log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-ddns action default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-ddns packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-grayware log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-grayware action sinkhole
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-grayware packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-parked log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-parked action default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-parked packet-capture disable
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-phishing log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-phishing action sinkhole
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-phishing packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-proxy log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-proxy action sinkhole
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-proxy packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-malware log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-malware action sinkhole
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-malware packet-capture single-packet
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-recent log-level default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-recent action default
set profiles spyware Outbound-AS botnet-domains dns-security-categories pan-dns-sec-recent packet-capture single-packet
set profiles spyware Outbound-AS rules Block-Critical-High-Medium action reset-both
set profiles spyware Outbound-AS rules Block-Critical-High-Medium severity [ high critical medium ]
set profiles spyware Outbound-AS rules Block-Critical-High-Medium threat-name any
set profiles spyware Outbound-AS rules Block-Critical-High-Medium category any
set profiles spyware Outbound-AS rules Block-Critical-High-Medium packet-capture single-packet
set profiles spyware Outbound-AS rules Default-Low-Info action default
set profiles spyware Outbound-AS rules Default-Low-Info severity [ low informational ]
set profiles spyware Outbound-AS rules Default-Low-Info threat-name any
set profiles spyware Outbound-AS rules Default-Low-Info category any
set profiles spyware Outbound-AS rules Default-Low-Info packet-capture disable
set profiles spyware Inbound-AS botnet-domains sinkhole ipv4-address sinkhole.paloaltonetworks.com
set profiles spyware Inbound-AS botnet-domains sinkhole ipv6-address 2600:5200::1
set profiles spyware Inbound-AS botnet-domains lists default-paloalto-dns packet-capture single-packet
set profiles spyware Inbound-AS botnet-domains lists default-paloalto-dns action sinkhole
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-benign log-level default
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-benign action default
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-benign packet-capture disable
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-cc log-level default
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-cc action sinkhole
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-cc packet-capture single-packet
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-ddns log-level default
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-ddns action default
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-ddns packet-capture single-packet
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-grayware log-level default
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-grayware action sinkhole
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-grayware packet-capture single-packet
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-parked log-level default
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-parked action default
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-parked packet-capture disable
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-phishing log-level default
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-phishing action sinkhole
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-phishing packet-capture single-packet
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-proxy log-level default
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-proxy action sinkhole
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-proxy packet-capture single-packet
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-malware log-level default
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-malware action sinkhole
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-malware packet-capture single-packet
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-recent log-level default
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-recent action default
set profiles spyware Inbound-AS botnet-domains dns-security-categories pan-dns-sec-recent packet-capture single-packet
set profiles spyware Inbound-AS rules Block-Critical-High-Medium action reset-both
set profiles spyware Inbound-AS rules Block-Critical-High-Medium severity [ high critical medium ]
set profiles spyware Inbound-AS rules Block-Critical-High-Medium threat-name any
set profiles spyware Inbound-AS rules Block-Critical-High-Medium category any
set profiles spyware Inbound-AS rules Block-Critical-High-Medium packet-capture single-packet
set profiles spyware Inbound-AS rules Default-Low-Info action default
set profiles spyware Inbound-AS rules Default-Low-Info severity [ low informational ]
set profiles spyware Inbound-AS rules Default-Low-Info threat-name any
set profiles spyware Inbound-AS rules Default-Low-Info category any
set profiles spyware Inbound-AS rules Default-Low-Info packet-capture disable
set profiles spyware Internal-AS botnet-domains sinkhole ipv4-address sinkhole.paloaltonetworks.com
set profiles spyware Internal-AS botnet-domains sinkhole ipv6-address 2600:5200::1
set profiles spyware Internal-AS botnet-domains lists default-paloalto-dns packet-capture single-packet
set profiles spyware Internal-AS botnet-domains lists default-paloalto-dns action sinkhole
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-benign log-level default
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-benign action default
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-benign packet-capture disable
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-cc log-level default
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-cc action sinkhole
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-cc packet-capture single-packet
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-ddns log-level default
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-ddns action default
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-ddns packet-capture single-packet
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-grayware log-level default
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-grayware action sinkhole
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-grayware packet-capture single-packet
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-parked log-level default
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-parked action default
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-parked packet-capture disable
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-phishing log-level default
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-phishing action sinkhole
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-phishing packet-capture single-packet
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-proxy log-level default
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-proxy action sinkhole
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-proxy packet-capture single-packet
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-malware log-level default
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-malware action sinkhole
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-malware packet-capture single-packet
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-recent log-level default
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-recent action default
set profiles spyware Internal-AS botnet-domains dns-security-categories pan-dns-sec-recent packet-capture single-packet
set profiles spyware Internal-AS rules Block-Critical-High action reset-both
set profiles spyware Internal-AS rules Block-Critical-High severity [ high critical ]
set profiles spyware Internal-AS rules Block-Critical-High threat-name any
set profiles spyware Internal-AS rules Block-Critical-High category any
set profiles spyware Internal-AS rules Block-Critical-High packet-capture single-packet
set profiles spyware Internal-AS rules Default-Medium-Low-Info action default
set profiles spyware Internal-AS rules Default-Medium-Low-Info severity [ low informational medium ]
set profiles spyware Internal-AS rules Default-Medium-Low-Info threat-name any
set profiles spyware Internal-AS rules Default-Medium-Low-Info category any
set profiles spyware Internal-AS rules Default-Medium-Low-Info packet-capture disable
set profiles spyware Alert-Only-AS botnet-domains sinkhole ipv4-address sinkhole.paloaltonetworks.com
set profiles spyware Alert-Only-AS botnet-domains sinkhole ipv6-address 2600:5200::1
set profiles spyware Alert-Only-AS botnet-domains lists default-paloalto-dns packet-capture disable
set profiles spyware Alert-Only-AS botnet-domains lists default-paloalto-dns action alert
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-benign log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-benign action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-benign packet-capture disable
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-cc log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-cc action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-cc packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-ddns log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-ddns action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-ddns packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-grayware log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-grayware action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-grayware packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-parked log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-parked action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-parked packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-phishing log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-phishing action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-phishing packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-proxy log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-proxy action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-proxy packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-malware log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-malware action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-malware packet-capture single-packet
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-recent log-level default
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-recent action allow
set profiles spyware Alert-Only-AS botnet-domains dns-security-categories pan-dns-sec-recent packet-capture single-packet
set profiles spyware Alert-Only-AS rules Alert-All action alert
set profiles spyware Alert-Only-AS rules Alert-All severity any
set profiles spyware Alert-Only-AS rules Alert-All threat-name any
set profiles spyware Alert-Only-AS rules Alert-All category any
set profiles spyware Alert-Only-AS rules Alert-All packet-capture disable
set profiles spyware Exception-AS description "Used for exception cases not part of the recommended practice"
set profiles spyware Exception-AS botnet-domains sinkhole ipv4-address sinkhole.paloaltonetworks.com
set profiles spyware Exception-AS botnet-domains sinkhole ipv6-address 2600:5200::1
set profiles spyware Exception-AS botnet-domains lists default-paloalto-dns packet-capture disable
set profiles spyware Exception-AS botnet-domains lists default-paloalto-dns action sinkhole
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-benign log-level default
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-benign action default
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-benign packet-capture disable
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-cc log-level default
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-cc action default
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-cc packet-capture single-packet
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-ddns log-level default
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-ddns action default
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-ddns packet-capture single-packet
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-malware log-level default
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-malware action default
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-malware packet-capture single-packet
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-recent log-level default
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-recent action default
set profiles spyware Exception-AS botnet-domains dns-security-categories pan-dns-sec-recent packet-capture single-packet

#URL Filtering Profile
set profiles custom-url-category Block type "URL List"
set profiles custom-url-category Allow type "URL List"
set profiles custom-url-category Custom-No-Decrypt type "URL List"
set profiles url-filtering Outbound-URL credential-enforcement mode ip-user
set profiles url-filtering Outbound-URL credential-enforcement log-severity high
set profiles url-filtering Outbound-URL credential-enforcement block [ Block Allow abortion abused-drugs adult alcohol-and-tobacco auctions business-and-economy command-and-control computer-and-internet-info content-delivery-networks copyright-infringement cryptocurrency dating dynamic-dns educational-institutions entertainment-and-arts extremism financial-services gambling games government grayware hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk malware medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy phishing private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate recreation-and-hobbies reference-and-research religion search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting encrypted-dns ransomware ]
set profiles url-filtering Outbound-URL log-http-hdr-user-agent yes
set profiles url-filtering Outbound-URL log-http-hdr-referer yes
set profiles url-filtering Outbound-URL log-http-hdr-xff yes
set profiles url-filtering Outbound-URL alert [ Allow abortion abused-drugs adult alcohol-and-tobacco auctions business-and-economy computer-and-internet-info content-delivery-networks copyright-infringement cryptocurrency dating dynamic-dns educational-institutions entertainment-and-arts extremism financial-services gambling games government hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate recreation-and-hobbies reference-and-research religion search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting encrypted-dns ransomware ]
set profiles url-filtering Outbound-URL block [ Block command-and-control grayware malware phishing ]
set profiles url-filtering Outbound-URL mlav-engine-urlbased-enabled "Phishing Detection" mlav-policy-action block
set profiles url-filtering Outbound-URL mlav-engine-urlbased-enabled "Javascript Exploit Detection" mlav-policy-action block
set profiles url-filtering Outbound-URL credential-enforcement alert real-time-detection
set profiles url-filtering Outbound-URL alert real-time-detection
set profiles url-filtering Alert-Only-URL credential-enforcement mode ip-user
set profiles url-filtering Alert-Only-URL credential-enforcement log-severity medium
set profiles url-filtering Alert-Only-URL credential-enforcement alert [ Block Allow abortion abused-drugs adult alcohol-and-tobacco auctions business-and-economy command-and-control computer-and-internet-info content-delivery-networks copyright-infringement cryptocurrency dating dynamic-dns educational-institutions entertainment-and-arts extremism financial-services gambling games government grayware hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk malware medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy phishing private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate recreation-and-hobbies reference-and-research religion search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting ]
set profiles url-filtering Alert-Only-URL alert [ Block Allow abortion abused-drugs adult alcohol-and-tobacco auctions business-and-economy command-and-control computer-and-internet-info content-delivery-networks copyright-infringement cryptocurrency dating dynamic-dns educational-institutions entertainment-and-arts extremism financial-services gambling games government grayware hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk malware medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy phishing private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate recreation-and-hobbies reference-and-research religion search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting encrypted-dns ransomware ]
set profiles url-filtering Alert-Only-URL mlav-engine-urlbased-enabled "Phishing Detection" mlav-policy-action alert
set profiles url-filtering Alert-Only-URL mlav-engine-urlbased-enabled "Javascript Exploit Detection" mlav-policy-action alert
set profiles url-filtering Alert-Only-URL credential-enforcement alert real-time-detection
set profiles url-filtering Alert-Only-URL alert real-time-detection
set profiles url-filtering Exception-URL credential-enforcement mode ip-user
set profiles url-filtering Exception-URL credential-enforcement log-severity high
set profiles url-filtering Exception-URL credential-enforcement block [ Block Allow abortion abused-drugs adult alcohol-and-tobacco auctions business-and-economy command-and-control computer-and-internet-info content-delivery-networks copyright-infringement cryptocurrency dating dynamic-dns educational-institutions entertainment-and-arts extremism financial-services gambling games government grayware hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk malware medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy phishing private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate recreation-and-hobbies reference-and-research religion search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting encrypted-dns ransomware ]
set profiles url-filtering Exception-URL log-http-hdr-user-agent yes
set profiles url-filtering Exception-URL log-http-hdr-referer yes
set profiles url-filtering Exception-URL log-http-hdr-xff yes
set profiles url-filtering Exception-URL alert [ Allow abortion abused-drugs adult alcohol-and-tobacco auctions business-and-economy computer-and-internet-info content-delivery-networks copyright-infringement cryptocurrency dating dynamic-dns educational-institutions entertainment-and-arts extremism financial-services gambling games government hacking health-and-medicine high-risk home-and-garden hunting-and-fishing insufficient-content internet-communications-and-telephony internet-portals job-search legal low-risk medium-risk military motor-vehicles music newly-registered-domain news not-resolved nudity online-storage-and-backup parked peer-to-peer personal-sites-and-blogs philosophy-and-political-advocacy private-ip-addresses proxy-avoidance-and-anonymizers questionable real-estate recreation-and-hobbies reference-and-research religion search-engines sex-education shareware-and-freeware shopping social-networking society sports stock-advice-and-tools streaming-media swimsuits-and-intimate-apparel training-and-tools translation travel unknown weapons web-advertisements web-based-email web-hosting ]
set profiles url-filtering Exception-URL block [ Block command-and-control grayware malware phishing encrypted-dns ransomware ]
set profiles url-filtering Exception-URL mlav-engine-urlbased-enabled "Phishing Detection" mlav-policy-action block
set profiles url-filtering Exception-URL mlav-engine-urlbased-enabled "Javascript Exploit Detection" mlav-policy-action block
set profiles url-filtering Exception-URL credential-enforcement alert real-time-detection
set profiles url-filtering Exception-URL alert real-time-detection

#AntiVirus Profiles
set profiles virus Alert-Only-AV decoder ftp action alert
set profiles virus Alert-Only-AV decoder ftp wildfire-action alert
set profiles virus Alert-Only-AV decoder ftp mlav-action alert
set profiles virus Alert-Only-AV decoder http action alert
set profiles virus Alert-Only-AV decoder http wildfire-action alert
set profiles virus Alert-Only-AV decoder http mlav-action alert
set profiles virus Alert-Only-AV decoder http2 action alert
set profiles virus Alert-Only-AV decoder http2 wildfire-action alert
set profiles virus Alert-Only-AV decoder http2 mlav-action alert
set profiles virus Alert-Only-AV decoder imap action alert
set profiles virus Alert-Only-AV decoder imap wildfire-action alert
set profiles virus Alert-Only-AV decoder imap mlav-action alert
set profiles virus Alert-Only-AV decoder pop3 action alert
set profiles virus Alert-Only-AV decoder pop3 wildfire-action alert
set profiles virus Alert-Only-AV decoder pop3 mlav-action alert
set profiles virus Alert-Only-AV decoder smb action alert
set profiles virus Alert-Only-AV decoder smb wildfire-action alert
set profiles virus Alert-Only-AV decoder smb mlav-action alert
set profiles virus Alert-Only-AV decoder smtp action alert
set profiles virus Alert-Only-AV decoder smtp wildfire-action alert
set profiles virus Alert-Only-AV decoder smtp mlav-action alert
set profiles virus Alert-Only-AV mlav-engine-filebased-enabled "Windows Executables" mlav-policy-action enable(alert-only)
set profiles virus Alert-Only-AV mlav-engine-filebased-enabled "PowerShell Script 1" mlav-policy-action enable(alert-only)
set profiles virus Alert-Only-AV mlav-engine-filebased-enabled "PowerShell Script 2" mlav-policy-action enable(alert-only)
set profiles virus Alert-Only-AV mlav-engine-filebased-enabled "Executable Linked Format" mlav-policy-action enable(alert-only)
set profiles virus Outbound-AV decoder ftp action reset-both
set profiles virus Outbound-AV decoder ftp wildfire-action reset-both
set profiles virus Outbound-AV decoder ftp mlav-action reset-both
set profiles virus Outbound-AV decoder http action reset-both
set profiles virus Outbound-AV decoder http wildfire-action reset-both
set profiles virus Outbound-AV decoder http mlav-action reset-both
set profiles virus Outbound-AV decoder http2 action reset-both
set profiles virus Outbound-AV decoder http2 wildfire-action reset-both
set profiles virus Outbound-AV decoder http2 mlav-action reset-both
set profiles virus Outbound-AV decoder imap action reset-both
set profiles virus Outbound-AV decoder imap wildfire-action reset-both
set profiles virus Outbound-AV decoder imap mlav-action reset-both
set profiles virus Outbound-AV decoder pop3 action reset-both
set profiles virus Outbound-AV decoder pop3 wildfire-action reset-both
set profiles virus Outbound-AV decoder pop3 mlav-action reset-both
set profiles virus Outbound-AV decoder smb action reset-both
set profiles virus Outbound-AV decoder smb wildfire-action reset-both
set profiles virus Outbound-AV decoder smb mlav-action reset-both
set profiles virus Outbound-AV decoder smtp action reset-both
set profiles virus Outbound-AV decoder smtp wildfire-action reset-both
set profiles virus Outbound-AV decoder smtp mlav-action reset-both
set profiles virus Outbound-AV mlav-engine-filebased-enabled "Windows Executables" mlav-policy-action enable
set profiles virus Outbound-AV mlav-engine-filebased-enabled "PowerShell Script 1" mlav-policy-action enable
set profiles virus Outbound-AV mlav-engine-filebased-enabled "PowerShell Script 2" mlav-policy-action enable
set profiles virus Outbound-AV mlav-engine-filebased-enabled "Executable Linked Format" mlav-policy-action enable
set profiles virus Inbound-AV decoder ftp action reset-both
set profiles virus Inbound-AV decoder ftp wildfire-action reset-both
set profiles virus Inbound-AV decoder ftp mlav-action reset-both
set profiles virus Inbound-AV decoder http action reset-both
set profiles virus Inbound-AV decoder http wildfire-action reset-both
set profiles virus Inbound-AV decoder http mlav-action reset-both
set profiles virus Inbound-AV decoder http2 action reset-both
set profiles virus Inbound-AV decoder http2 wildfire-action reset-both
set profiles virus Inbound-AV decoder http2 mlav-action reset-both
set profiles virus Inbound-AV decoder imap action reset-both
set profiles virus Inbound-AV decoder imap wildfire-action reset-both
set profiles virus Inbound-AV decoder imap mlav-action reset-both
set profiles virus Inbound-AV decoder pop3 action reset-both
set profiles virus Inbound-AV decoder pop3 wildfire-action reset-both
set profiles virus Inbound-AV decoder pop3 mlav-action reset-both
set profiles virus Inbound-AV decoder smb action reset-both
set profiles virus Inbound-AV decoder smb wildfire-action reset-both
set profiles virus Inbound-AV decoder smb mlav-action reset-both
set profiles virus Inbound-AV decoder smtp action reset-both
set profiles virus Inbound-AV decoder smtp wildfire-action reset-both
set profiles virus Inbound-AV decoder smtp mlav-action reset-both
set profiles virus Inbound-AV mlav-engine-filebased-enabled "Windows Executables" mlav-policy-action enable
set profiles virus Inbound-AV mlav-engine-filebased-enabled "PowerShell Script 1" mlav-policy-action enable
set profiles virus Inbound-AV mlav-engine-filebased-enabled "PowerShell Script 2" mlav-policy-action enable
set profiles virus Inbound-AV mlav-engine-filebased-enabled "Executable Linked Format" mlav-policy-action enable
set profiles virus Internal-AV decoder ftp action reset-both
set profiles virus Internal-AV decoder ftp wildfire-action reset-both
set profiles virus Internal-AV decoder ftp mlav-action reset-both
set profiles virus Internal-AV decoder http action reset-both
set profiles virus Internal-AV decoder http wildfire-action reset-both
set profiles virus Internal-AV decoder http mlav-action reset-both
set profiles virus Internal-AV decoder http2 action reset-both
set profiles virus Internal-AV decoder http2 wildfire-action reset-both
set profiles virus Internal-AV decoder http2 mlav-action reset-both
set profiles virus Internal-AV decoder imap action reset-both
set profiles virus Internal-AV decoder imap wildfire-action reset-both
set profiles virus Internal-AV decoder imap mlav-action reset-both
set profiles virus Internal-AV decoder pop3 action reset-both
set profiles virus Internal-AV decoder pop3 wildfire-action reset-both
set profiles virus Internal-AV decoder pop3 mlav-action reset-both
set profiles virus Internal-AV decoder smb action reset-both
set profiles virus Internal-AV decoder smb wildfire-action reset-both
set profiles virus Internal-AV decoder smb mlav-action reset-both
set profiles virus Internal-AV decoder smtp action reset-both
set profiles virus Internal-AV decoder smtp wildfire-action reset-both
set profiles virus Internal-AV decoder smtp mlav-action reset-both
set profiles virus Internal-AV mlav-engine-filebased-enabled "Windows Executables" mlav-policy-action enable
set profiles virus Internal-AV mlav-engine-filebased-enabled "PowerShell Script 1" mlav-policy-action enable
set profiles virus Internal-AV mlav-engine-filebased-enabled "PowerShell Script 2" mlav-policy-action enable
set profiles virus Internal-AV mlav-engine-filebased-enabled "Executable Linked Format" mlav-policy-action enable
set profiles virus Exception-AV decoder ftp action reset-both
set profiles virus Exception-AV decoder ftp wildfire-action reset-both
set profiles virus Exception-AV decoder ftp mlav-action reset-both
set profiles virus Exception-AV decoder http action reset-both
set profiles virus Exception-AV decoder http wildfire-action reset-both
set profiles virus Exception-AV decoder http mlav-action reset-both
set profiles virus Exception-AV decoder http2 action reset-both
set profiles virus Exception-AV decoder http2 wildfire-action reset-both
set profiles virus Exception-AV decoder http2 mlav-action reset-both
set profiles virus Exception-AV decoder imap action reset-both
set profiles virus Exception-AV decoder imap wildfire-action reset-both
set profiles virus Exception-AV decoder imap mlav-action reset-both
set profiles virus Exception-AV decoder pop3 action reset-both
set profiles virus Exception-AV decoder pop3 wildfire-action reset-both
set profiles virus Exception-AV decoder pop3 mlav-action reset-both
set profiles virus Exception-AV decoder smb action reset-both
set profiles virus Exception-AV decoder smb wildfire-action reset-both
set profiles virus Exception-AV decoder smb mlav-action reset-both
set profiles virus Exception-AV decoder smtp action reset-both
set profiles virus Exception-AV decoder smtp wildfire-action reset-both
set profiles virus Exception-AV decoder smtp mlav-action reset-both
set profiles virus Exception-AV mlav-engine-filebased-enabled "Windows Executables" mlav-policy-action enable
set profiles virus Exception-AV mlav-engine-filebased-enabled "PowerShell Script 1" mlav-policy-action enable
set profiles virus Exception-AV mlav-engine-filebased-enabled "PowerShell Script 2" mlav-policy-action enable
set profiles virus Exception-AV mlav-engine-filebased-enabled "Executable Linked Format" mlav-policy-action enable
set profiles virus Exception-AV description "Use this profile for rules needing modifications to the standard"

#Vulnerability Protection Profile
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium action reset-both
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium vendor-id any
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium severity [ critical high medium ]
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium cve any
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium threat-name any
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium host any
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium category any
set profiles vulnerability Outbound-VP rules Block-Critical-High-Medium packet-capture single-packet
set profiles vulnerability Outbound-VP rules Default-Low-Info action default
set profiles vulnerability Outbound-VP rules Default-Low-Info vendor-id any
set profiles vulnerability Outbound-VP rules Default-Low-Info severity [ low informational ]
set profiles vulnerability Outbound-VP rules Default-Low-Info cve any
set profiles vulnerability Outbound-VP rules Default-Low-Info threat-name any
set profiles vulnerability Outbound-VP rules Default-Low-Info host any
set profiles vulnerability Outbound-VP rules Default-Low-Info category any
set profiles vulnerability Outbound-VP rules Default-Low-Info packet-capture disable
set profiles vulnerability Inbound-VP rules Block-Critical-High-Medium action reset-both
set profiles vulnerability Inbound-VP rules Block-Critical-High-Medium vendor-id any
set profiles vulnerability Inbound-VP rules Block-Critical-High-Medium severity [ critical high medium ]
set profiles vulnerability Inbound-VP rules Block-Critical-High-Medium cve any
set profiles vulnerability Inbound-VP rules Block-Critical-High-Medium threat-name any
set profiles vulnerability Inbound-VP rules Block-Critical-High-Medium host any
set profiles vulnerability Inbound-VP rules Block-Critical-High-Medium category any
set profiles vulnerability Inbound-VP rules Block-Critical-High-Medium packet-capture single-packet
set profiles vulnerability Inbound-VP rules Default-Low-Info action default
set profiles vulnerability Inbound-VP rules Default-Low-Info vendor-id any
set profiles vulnerability Inbound-VP rules Default-Low-Info severity [ low informational ]
set profiles vulnerability Inbound-VP rules Default-Low-Info cve any
set profiles vulnerability Inbound-VP rules Default-Low-Info threat-name any
set profiles vulnerability Inbound-VP rules Default-Low-Info host any
set profiles vulnerability Inbound-VP rules Default-Low-Info category any
set profiles vulnerability Inbound-VP rules Default-Low-Info packet-capture disable
set profiles vulnerability Internal-VP rules Block-Critical-High action reset-both
set profiles vulnerability Internal-VP rules Block-Critical-High vendor-id any
set profiles vulnerability Internal-VP rules Block-Critical-High severity [ critical high ]
set profiles vulnerability Internal-VP rules Block-Critical-High cve any
set profiles vulnerability Internal-VP rules Block-Critical-High threat-name any
set profiles vulnerability Internal-VP rules Block-Critical-High host any
set profiles vulnerability Internal-VP rules Block-Critical-High category any
set profiles vulnerability Internal-VP rules Block-Critical-High packet-capture single-packet
set profiles vulnerability Internal-VP rules Default-Medium-Low-Info action default
set profiles vulnerability Internal-VP rules Default-Medium-Low-Info vendor-id any
set profiles vulnerability Internal-VP rules Default-Medium-Low-Info severity [ low informational medium ]
set profiles vulnerability Internal-VP rules Default-Medium-Low-Info cve any
set profiles vulnerability Internal-VP rules Default-Medium-Low-Info threat-name any
set profiles vulnerability Internal-VP rules Default-Medium-Low-Info host any
set profiles vulnerability Internal-VP rules Default-Medium-Low-Info category any
set profiles vulnerability Internal-VP rules Default-Medium-Low-Info packet-capture disable
set profiles vulnerability Alert-Only-VP rules Alert-All action alert
set profiles vulnerability Alert-Only-VP rules Alert-All vendor-id any
set profiles vulnerability Alert-Only-VP rules Alert-All severity any
set profiles vulnerability Alert-Only-VP rules Alert-All cve any
set profiles vulnerability Alert-Only-VP rules Alert-All threat-name any
set profiles vulnerability Alert-Only-VP rules Alert-All host any
set profiles vulnerability Alert-Only-VP rules Alert-All category any
set profiles vulnerability Alert-Only-VP rules Alert-All packet-capture disable
set profiles vulnerability Exception-VP

#Wildfire Analysis Profiles
set profiles wildfire-analysis Outbound-WF rules Forward-All application any
set profiles wildfire-analysis Outbound-WF rules Forward-All file-type any
set profiles wildfire-analysis Outbound-WF rules Forward-All direction both
set profiles wildfire-analysis Outbound-WF rules Forward-All analysis public-cloud
set profiles wildfire-analysis Inbound-WF rules Forward-All application any
set profiles wildfire-analysis Inbound-WF rules Forward-All file-type any
set profiles wildfire-analysis Inbound-WF rules Forward-All direction both
set profiles wildfire-analysis Inbound-WF rules Forward-All analysis public-cloud
set profiles wildfire-analysis Internal-WF rules Forward-All application any
set profiles wildfire-analysis Internal-WF rules Forward-All file-type any
set profiles wildfire-analysis Internal-WF rules Forward-All direction both
set profiles wildfire-analysis Internal-WF rules Forward-All analysis public-cloud
set profiles wildfire-analysis Alert-Only-WF rules Forward-All application any
set profiles wildfire-analysis Alert-Only-WF rules Forward-All file-type any
set profiles wildfire-analysis Alert-Only-WF rules Forward-All direction both
set profiles wildfire-analysis Alert-Only-WF rules Forward-All analysis public-cloud

#Profile Groups
set profile-group Outbound virus Outbound-AV
set profile-group Outbound spyware Outbound-AS
set profile-group Outbound vulnerability Outbound-VP
set profile-group Outbound url-filtering Outbound-URL
set profile-group Outbound file-blocking Outbound-FB
set profile-group Outbound wildfire-analysis Outbound-WF
set profile-group Inbound virus Inbound-AV
set profile-group Inbound spyware Inbound-AS
set profile-group Inbound vulnerability Inbound-VP
set profile-group Inbound file-blocking Inbound-FB
set profile-group Inbound wildfire-analysis Inbound-WF
set profile-group Internal virus Internal-AV
set profile-group Internal spyware Internal-AS
set profile-group Internal vulnerability Internal-VP
set profile-group Internal file-blocking Internal-FB
set profile-group Internal wildfire-analysis Internal-WF
set profile-group Alert-Only virus Alert-Only-AV
set profile-group Alert-Only spyware Alert-Only-AS
set profile-group Alert-Only vulnerability Alert-Only-VP
set profile-group Alert-Only url-filtering Alert-Only-URL
set profile-group Alert-Only file-blocking Alert-Only-FB
set profile-group Alert-Only wildfire-analysis Alert-Only-WF
set profile-group default virus Outbound-AV
set profile-group default spyware Outbound-AS
set profile-group default vulnerability Outbound-VP
set profile-group default url-filtering Outbound-URL
set profile-group default file-blocking Outbound-FB
set profile-group default wildfire-analysis Outbound-WF

#Security Rules
set rulebase security rules "Outbound Block Rule" description "Block outbound sessions with destination address matching one of the Palo Alto Networks external dynamic lists for high risk and known malicious IP addresses."
set rulebase security rules "Outbound Block Rule" to any
set rulebase security rules "Outbound Block Rule" from any
set rulebase security rules "Outbound Block Rule" source any
set rulebase security rules "Outbound Block Rule" destination [ panw-highrisk-ip-list panw-known-ip-list panw-bulletproof-ip-list ]
set rulebase security rules "Outbound Block Rule" source-user any
set rulebase security rules "Outbound Block Rule" category any
set rulebase security rules "Outbound Block Rule" application any
set rulebase security rules "Outbound Block Rule" service any
set rulebase security rules "Outbound Block Rule" source-hip any
set rulebase security rules "Outbound Block Rule" action deny
set rulebase security rules "Outbound Block Rule" tag Outbound
set rulebase security rules "Inbound Block Rule" description "Block inbound sessions with source address matching one of the Palo Alto Networks external dynamic lists for high risk and known malicious IP addresses."
set rulebase security rules "Inbound Block Rule" to any
set rulebase security rules "Inbound Block Rule" from any
set rulebase security rules "Inbound Block Rule" source [ panw-highrisk-ip-list panw-known-ip-list panw-bulletproof-ip-list ]
set rulebase security rules "Inbound Block Rule" destination any
set rulebase security rules "Inbound Block Rule" source-user any
set rulebase security rules "Inbound Block Rule" category any
set rulebase security rules "Inbound Block Rule" application any
set rulebase security rules "Inbound Block Rule" service any
set rulebase security rules "Inbound Block Rule" source-hip any
set rulebase security rules "Inbound Block Rule" action drop
set rulebase security rules "Inbound Block Rule" tag Inbound

#Recommended Decryption Profiles
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-expired-certificate yes
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-untrusted-issuer yes
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-unknown-cert yes
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-timeout-cert yes
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-unsupported-version yes
set profiles decryption Recommended_Decryption_Profile ssl-forward-proxy block-unsupported-cipher yes
set profiles decryption Recommended_Decryption_Profile ssl-no-proxy block-expired-certificate yes
set profiles decryption Recommended_Decryption_Profile ssl-no-proxy block-untrusted-issuer yes
set profiles decryption Recommended_Decryption_Profile ssl-inbound-proxy block-unsupported-version no
set profiles decryption Recommended_Decryption_Profile ssl-inbound-proxy block-unsupported-cipher no
set profiles decryption Recommended_Decryption_Profile ssh-proxy block-unsupported-version yes
set profiles decryption Recommended_Decryption_Profile ssh-proxy block-unsupported-alg yes
set profiles decryption Recommended_Decryption_Profile ssl-protocol-settings min-version tls1-2
set profiles decryption Recommended_Decryption_Profile ssl-protocol-settings max-version tls1-3
set profiles decryption Recommended_Decryption_Profile ssl-protocol-settings keyxchg-algo-rsa no
set profiles decryption Recommended_Decryption_Profile ssl-protocol-settings enc-algo-3des no
set profiles decryption Recommended_Decryption_Profile ssl-protocol-settings enc-algo-rc4 no
set profiles decryption Recommended_Decryption_Profile ssl-protocol-settings auth-algo-sha1 no

#Recommended Decryption NO DECRYPT rules for SSL checks even if not decrypting
set rulebase decryption rules "NO-Decrypt URL Categories" category [ financial-services government health-and-medicine Custom-No-Decrypt ]
set rulebase decryption rules "NO-Decrypt URL Categories" service any
set rulebase decryption rules "NO-Decrypt URL Categories" type ssl-forward-proxy
set rulebase decryption rules "NO-Decrypt URL Categories" from any
set rulebase decryption rules "NO-Decrypt URL Categories" to any
set rulebase decryption rules "NO-Decrypt URL Categories" source any
set rulebase decryption rules "NO-Decrypt URL Categories" destination any
set rulebase decryption rules "NO-Decrypt URL Categories" source-user any
set rulebase decryption rules "NO-Decrypt URL Categories" profile Recommended_Decryption_Profile
set rulebase decryption rules "NO-Decrypt URL Categories" action no-decrypt
set rulebase decryption rules "NO-Decrypt URL Categories" disabled yes
set rulebase decryption rules "NO-Decrypt URL Categories" description "This rule does not do Decryption.  This rule is validating SSL Protocol Communications."

#Zone Protection Profiles - To Be Added to each Configured Zone
set network profiles zone-protection-profile Recommended_Zone_Protection scan 8001 action alert
set network profiles zone-protection-profile Recommended_Zone_Protection scan 8001 interval 2
set network profiles zone-protection-profile Recommended_Zone_Protection scan 8001 threshold 100
set network profiles zone-protection-profile Recommended_Zone_Protection scan 8002 action alert
set network profiles zone-protection-profile Recommended_Zone_Protection scan 8002 interval 10
set network profiles zone-protection-profile Recommended_Zone_Protection scan 8002 threshold 100
set network profiles zone-protection-profile Recommended_Zone_Protection scan 8003 action alert
set network profiles zone-protection-profile Recommended_Zone_Protection scan 8003 interval 2
set network profiles zone-protection-profile Recommended_Zone_Protection scan 8003 threshold 100
set network profiles zone-protection-profile Recommended_Zone_Protection discard-ip-spoof yes
set network profiles zone-protection-profile Recommended_Zone_Protection discard-malformed-option yes
set network profiles zone-protection-profile Recommended_Zone_Protection remove-tcp-timestamp yes
set network profiles zone-protection-profile Recommended_Zone_Protection strip-tcp-fast-open-and-data no
set network profiles zone-protection-profile Recommended_Zone_Protection strip-mptcp-option global

#General Reports
set shared reports "Host-visit malicious sites plus" period last-7-calendar-days
set shared reports "Host-visit malicious sites plus" topn 500
set shared reports "Host-visit malicious sites plus" topm 50
set shared reports "Host-visit malicious sites plus" caption "Host-visit malicious sites plus"
set shared reports "Host-visit malicious sites plus" frequency daily
set shared reports "Host-visit malicious sites plus" query "(category eq command-and-control) or (category eq hacking) or (category eq malware) or (category eq phishing) or (category eq grayware)"
set shared reports "Host-visit malicious sites plus" type url sortby repeatcnt
set shared reports "Host-visit malicious sites plus" type url group-by src
set shared reports "Host-visit malicious sites plus" type url aggregate-by [ from srcuser category action ]
set shared reports "Host-visit malicious sites plus" type url values repeatcnt
set shared reports "Hosts visit malicious sites" period last-7-calendar-days
set shared reports "Hosts visit malicious sites" topn 500
set shared reports "Hosts visit malicious sites" topm 50
set shared reports "Hosts visit malicious sites" caption "Hosts visit malicious sites"
set shared reports "Hosts visit malicious sites" frequency daily
set shared reports "Hosts visit malicious sites" query "(category eq command-and-control) or (category eq hacking) or (category eq malware) or (category eq phishing) or (category eq grayware)"
set shared reports "Hosts visit malicious sites" type url sortby repeatcnt
set shared reports "Hosts visit malicious sites" type url group-by src
set shared reports "Hosts visit malicious sites" type url aggregate-by [ from srcuser ]
set shared reports "Hosts visit malicious sites" type url values repeatcnt
set shared reports "Hosts visit questionable sites" period last-7-calendar-days
set shared reports "Hosts visit questionable sites" topn 500
set shared reports "Hosts visit questionable sites" topm 50
set shared reports "Hosts visit questionable sites" caption "Hosts visit questionable sites"
set shared reports "Hosts visit questionable sites" frequency daily
set shared reports "Hosts visit questionable sites" query "(category eq dynamic-dns) and (category eq parked) and (category eq questionable) and (category eq unknown)"
set shared reports "Hosts visit questionable sites" type url sortby repeatcnt
set shared reports "Hosts visit questionable sites" type url group-by src
set shared reports "Hosts visit questionable sites" type url aggregate-by [ from srcuser ]
set shared reports "Hosts visit questionable sites" type url values repeatcnt
set shared reports "Host-visit quest sites plus" period last-7-calendar-days
set shared reports "Host-visit quest sites plus" topn 500
set shared reports "Host-visit quest sites plus" topm 50
set shared reports "Host-visit quest sites plus" caption "Host-visit quest sites plus"
set shared reports "Host-visit quest sites plus" frequency daily
set shared reports "Host-visit quest sites plus" query "(category eq dynamic-dns) and (category eq parked) and (category eq questionable) and (category eq unknown)"
set shared reports "Host-visit quest sites plus" description "Detail of hosts visiting questionable URLs"
set shared reports "Host-visit quest sites plus" type url sortby repeatcnt
set shared reports "Host-visit quest sites plus" type url group-by src
set shared reports "Host-visit quest sites plus" type url aggregate-by [ from srcuser category action ]
set shared reports "Host-visit quest sites plus" type url values repeatcnt
set shared reports "Wildfire malicious verdicts" period last-30-calendar-days
set shared reports "Wildfire malicious verdicts" topn 500
set shared reports "Wildfire malicious verdicts" topm 10
set shared reports "Wildfire malicious verdicts" caption "Wildfire malicious verdicts"
set shared reports "Wildfire malicious verdicts" frequency daily
set shared reports "Wildfire malicious verdicts" query "(app neq smtp) and (category neq benign)"
set shared reports "Wildfire malicious verdicts" description "Files uploaded or downloaded that were later found to be malicious. This is a summary. Act on real-time email."
set shared reports "Wildfire malicious verdicts" type wildfire sortby repeatcnt
set shared reports "Wildfire malicious verdicts" type wildfire aggregate-by [ filedigest container-of-app app category filetype rule ]
set shared reports "Wildfire malicious verdicts" type wildfire values repeatcnt
set shared reports "Wildfire verdicts SMTP" period last-30-calendar-days
set shared reports "Wildfire verdicts SMTP" topn 500
set shared reports "Wildfire verdicts SMTP" topm 10
set shared reports "Wildfire verdicts SMTP" caption "Wildfire verdicts SMTP"
set shared reports "Wildfire verdicts SMTP" frequency daily
set shared reports "Wildfire verdicts SMTP" query "(app eq smtp) and (category neq benign)"
set shared reports "Wildfire verdicts SMTP" description "Links sent from emails found to be malicious. "
set shared reports "Wildfire verdicts SMTP" type wildfire sortby repeatcnt
set shared reports "Wildfire verdicts SMTP" type wildfire aggregate-by [ filedigest container-of-app app category filetype rule subject sender recipient misc ]
set shared reports "Clients sinkholed" period last-30-calendar-days
set shared reports "Clients sinkholed" topn 500
set shared reports "Clients sinkholed" topm 50
set shared reports "Clients sinkholed" caption "Clients sinkholed"
set shared reports "Clients sinkholed" query "(rule eq 'DNS Sinkhole Block')"
set shared reports "Clients sinkholed" frequency daily
set shared reports "Clients sinkholed" type traffic sortby repeatcnt
set shared reports "Clients sinkholed" type traffic group-by from
set shared reports "Clients sinkholed" type traffic aggregate-by [ src srcuser ]
set shared reports "Clients sinkholed" type traffic values repeatcnt

#Bogon Filtering - based on https://github.com/openbsd/src/blob/master/etc/examples/bgpd.conf
set tag bogon color color8
set tag bogon comments "Bogus Networks Filter"
set address "RFC1918 - 192.168" ip-netmask 192.168.0.0/16
set address "RFC1918 - 172.16" ip-netmask 172.16.0.0/12
set address "RFC1918 - 10.0" ip-netmask 10.0.0.0/8
set address "RFC3927 - 169.254" ip-netmask 169.254.0.0/16
set address "RFC4193 - fd00" ip-netmask fd00::/8
set address "RFC4291 - fe80" ip-netmask fe80::/10
set address-group "RFC1918 Private Addresses" static [ "RFC1918 - 10.0" "RFC1918 - 192.168" "RFC1918 - 172.16" "RFC4193 - fd00" "RFC3927 - 169.254" "RFC4291 - fe80" ]
set rulebase security rules "Bogon filter" to untrust
set rulebase security rules "Bogon filter" from any
set rulebase security rules "Bogon filter" source any
set rulebase security rules "Bogon filter" destination "RFC1918 Private Addresses"
set rulebase security rules "Bogon filter" source-user any
set rulebase security rules "Bogon filter" category any
set rulebase security rules "Bogon filter" application any
set rulebase security rules "Bogon filter" service any
set rulebase security rules "Bogon filter" source-hip any
set rulebase security rules "Bogon filter" destination-hip any
set rulebase security rules "Bogon filter" tag bogon
set rulebase security rules "Bogon filter" action deny

#Bogon Discarding
set network virtual-router default routing-table ip static-route 10.0.0.0-8 destination 10.0.0.0/8 nexthop discard
set network virtual-router default routing-table ip static-route 10.0.0.0-8 path-monitor enable no
set network virtual-router default routing-table ip static-route 10.0.0.0-8 path-monitor failure-condition any
set network virtual-router default routing-table ip static-route 10.0.0.0-8 path-monitor hold-time 2
set network virtual-router default routing-table ip static-route 10.0.0.0-8 nexthop discard
set network virtual-router default routing-table ip static-route 10.0.0.0-8 bfd profile None
set network virtual-router default routing-table ip static-route 10.0.0.0-8 metric 65530
set network virtual-router default routing-table ip static-route 10.0.0.0-8 route-table unicast
set network virtual-router default routing-table ip static-route 127.0.0.0-8 destination 127.0.0.0/8 nexthop discard
set network virtual-router default routing-table ip static-route 127.0.0.0-8 path-monitor enable no
set network virtual-router default routing-table ip static-route 127.0.0.0-8 path-monitor failure-condition any
set network virtual-router default routing-table ip static-route 127.0.0.0-8 path-monitor hold-time 2
set network virtual-router default routing-table ip static-route 127.0.0.0-8 bfd profile None
set network virtual-router default routing-table ip static-route 127.0.0.0-8 metric 65530
set network virtual-router default routing-table ip static-route 127.0.0.0-8 route-table unicast
set network virtual-router default routing-table ip static-route 169.254.0.0-16 destination 169.254.0.0/16 nexthop discard
set network virtual-router default routing-table ip static-route 169.254.0.0-16 path-monitor enable no
set network virtual-router default routing-table ip static-route 169.254.0.0-16 path-monitor failure-condition any
set network virtual-router default routing-table ip static-route 169.254.0.0-16 path-monitor hold-time 2
set network virtual-router default routing-table ip static-route 169.254.0.0-16 bfd profile None
set network virtual-router default routing-table ip static-route 169.254.0.0-16 metric 65530
set network virtual-router default routing-table ip static-route 169.254.0.0-16 route-table unicast
set network virtual-router default routing-table ip static-route 172.16.0.0-12 destination 172.160.0.0/12 nexthop discard
set network virtual-router default routing-table ip static-route 172.16.0.0-12 path-monitor enable no
set network virtual-router default routing-table ip static-route 172.16.0.0-12 path-monitor failure-condition any
set network virtual-router default routing-table ip static-route 172.16.0.0-12 path-monitor hold-time 2
set network virtual-router default routing-table ip static-route 172.16.0.0-12 nexthop discard
set network virtual-router default routing-table ip static-route 172.16.0.0-12 bfd profile None
set network virtual-router default routing-table ip static-route 172.16.0.0-12 metric 65530
set network virtual-router default routing-table ip static-route 172.16.0.0-12 route-table unicast
set network virtual-router default routing-table ip static-route 192.168.0.0-16 destination 192.168.0.0/16 nexthop discard
set network virtual-router default routing-table ip static-route 192.168.0.0-16 path-monitor enable no
set network virtual-router default routing-table ip static-route 192.168.0.0-16 path-monitor failure-condition any
set network virtual-router default routing-table ip static-route 192.168.0.0-16 path-monitor hold-time 2
set network virtual-router default routing-table ip static-route 192.168.0.0-16 nexthop discard
set network virtual-router default routing-table ip static-route 192.168.0.0-16 bfd profile None
set network virtual-router default routing-table ip static-route 192.168.0.0-16 metric 65530
set network virtual-router default routing-table ip static-route 192.168.0.0-16 route-table unicast
set network virtual-router default routing-table ipv6 static-route 0-8 destination ::/8 nexthop discard
set network virtual-router default routing-table ipv6 static-route 0-8 path-monitor enable no
set network virtual-router default routing-table ipv6 static-route 0-8 path-monitor failure-condition any
set network virtual-router default routing-table ipv6 static-route 0-8 path-monitor hold-time 2
set network virtual-router default routing-table ipv6 static-route 0-8 bfd profile None
set network virtual-router default routing-table ipv6 static-route 0-8 metric 65530
set network virtual-router default routing-table ipv6 static-route 0-8 route-table unicast

##USE THE FOLLOWING WITH CAUTION - INTERNET CONNECTED ROUTERS WILL USE IT
#BGP NoExport Private Networks
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" action deny
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 0.0.0.0/8 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 10.0.0.0/8 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 100.64.0.0/10 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 127.0.0.0/8 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 169.254.0.0/16 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 172.16.0.0/12 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 192.0.2.0/24 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 192.88.99.0/24 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 192.168.0.0/16 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 198.18.0.0/15 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 198.51.100.0/24 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 203.0.113.0/24 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 224.0.0.0/4 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" match address-prefix 240.0.0.0/4 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v4" enable yes
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" action deny
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" match address-prefix ::/8 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" match address-prefix 100::/64 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" match address-prefix 2001:2::/48 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" match address-prefix 2001:10::/28 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" match address-prefix 2001:db8::/32 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" match address-prefix 2002::/16 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" match address-prefix 3ffe::/16 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" match address-prefix fc00::/7 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" match address-prefix fe80::/10 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" match address-prefix fec0::/10 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" match address-prefix ff00::/8 exact no
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" match route-table unicast
set network virtual-router default protocol bgp policy export rules "NoExport Private v6" enable yes

#BGP NoImport Private Networks
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" action deny
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 0.0.0.0/8 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 10.0.0.0/8 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 100.64.0.0/10 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 127.0.0.0/8 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 169.254.0.0/16 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 172.16.0.0/12 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 192.0.2.0/24 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 192.88.99.0/24 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 192.168.0.0/16 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 198.18.0.0/15 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 198.51.100.0/24 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 203.0.113.0/24 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 224.0.0.0/4 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" match address-prefix 240.0.0.0/4 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v4" enable yes
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" action deny
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" match address-prefix ::/8 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" match address-prefix 100::/64 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" match address-prefix 2001:2::/48 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" match address-prefix 2001:10::/28 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" match address-prefix 2001:db8::/32 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" match address-prefix 2002::/16 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" match address-prefix 3ffe::/16 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" match address-prefix fc00::/7 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" match address-prefix fe80::/10 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" match address-prefix fec0::/10 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" match address-prefix ff00::/8 exact no
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" match route-table unicast
set network virtual-router default protocol bgp policy import rules "NoImport Private v6" enable yes

#PANW Sinkhole Rule
set rulebase security rules "PANW Sinkhole" to untrust
set rulebase security rules "PANW Sinkhole" from any
set rulebase security rules "PANW Sinkhole" source any
set rulebase security rules "PANW Sinkhole" destination [ 72.5.65.111 2600:5200::1 ]
set rulebase security rules "PANW Sinkhole" source-user any
set rulebase security rules "PANW Sinkhole" category any
set rulebase security rules "PANW Sinkhole" application any
set rulebase security rules "PANW Sinkhole" service any
set rulebase security rules "PANW Sinkhole" source-hip any
set rulebase security rules "PANW Sinkhole" destination-hip any
set rulebase security rules "PANW Sinkhole" action deny

#Report Groups
set shared report-group "Possible Compromise" custom-widget 1 custom-report "Clients sinkholed"
set shared report-group "Possible Compromise" custom-widget 2 custom-report "Wildfire malicious verdicts"
set shared report-group "Possible Compromise" custom-widget 3 custom-report "Wildfire verdicts SMTP"
set shared report-group "Possible Compromise" custom-widget 4 custom-report "Hosts visit malicious sites"
set shared report-group "Possible Compromise" custom-widget 5 custom-report "Host-visit malicious sites plus"
set shared report-group "Possible Compromise" custom-widget 6 custom-report "Hosts visit questionable sites"
set shared report-group "Possible Compromise" custom-widget 7 custom-report "Host-visit quest sites plus"
set shared report-group "Possible Compromise" title-page yes
set shared report-group "Possible Compromise" variable title value "Possible Compromise"

#Palo recommended default rules
set rulebase default-security-rules rules intrazone-default action allow
set rulebase default-security-rules rules intrazone-default log-start no
set rulebase default-security-rules rules intrazone-default log-end yes
set rulebase default-security-rules rules intrazone-default profile-setting group Inbound
set rulebase default-security-rules rules interzone-default action drop
set rulebase default-security-rules rules interzone-default log-start no
set rulebase default-security-rules rules interzone-default log-end yes

#Ping only management profile
set network profiles interface-management-profile pingonly ping yes

#Block QUIC
set service udp-80 protocol udp port 80
set service udp-80 protocol udp override no
set service udp-443 protocol udp port 443
set service udp-443 protocol udp override no
set rulebase security rules "Block QUIC" to untrust
set rulebase security rules "Block QUIC" from any
set rulebase security rules "Block QUIC" source any
set rulebase security rules "Block QUIC" destination any
set rulebase security rules "Block QUIC" source-user any
set rulebase security rules "Block QUIC" category any
set rulebase security rules "Block QUIC" application any
set rulebase security rules "Block QUIC" service [ udp-80 udp-443 ]
set rulebase security rules "Block QUIC" source-hip any
set rulebase security rules "Block QUIC" destination-hip any
set rulebase security rules "Block QUIC" action deny

#secure SSL/TLS profile
set shared ssl-tls-service-profile secure-tls protocol-settings max-version max
set shared ssl-tls-service-profile secure-tls protocol-settings min-version tls1-2
set shared ssl-tls-service-profile secure-tls protocol-settings auth-algo-sha1 no
set shared ssl-tls-service-profile secure-tls protocol-settings enc-algo-3des no
set shared ssl-tls-service-profile secure-tls protocol-settings enc-algo-rc4 no
set shared ssl-tls-service-profile secure-tls protocol-settings keyxchg-algo-dhe no
set shared ssl-tls-service-profile secure-tls protocol-settings auth-algo-sha256 no
set shared ssl-tls-service-profile secure-tls protocol-settings enc-algo-aes-128-cbc no
set shared ssl-tls-service-profile secure-tls protocol-settings enc-algo-aes-128-gcm no
set shared ssl-tls-service-profile secure-tls protocol-settings keyxchg-algo-rsa no
set shared ssl-tls-service-profile secure-tls certificate example-cert

#P2P application block
set application-filter p2p-applications technology peer-to-peer
set application-filter p2p-applications risk [ 4 5 ]
set application-filter p2p-applications exclude skype
set application-filter p2p-applications prone-to-misuse yes
set rulebase security rules "p2p block" to untrust
set rulebase security rules "p2p block" from any
set rulebase security rules "p2p block" source any
set rulebase security rules "p2p block" destination any
set rulebase security rules "p2p block" source-user any
set rulebase security rules "p2p block" category any
set rulebase security rules "p2p block" application p2p-applications
set rulebase security rules "p2p block" service any
set rulebase security rules "p2p block" source-hip any
set rulebase security rules "p2p block" destination-hip any
set rulebase security rules "p2p block" action deny
set rulebase security rules "p2p block" rule-type interzone

#PREVENT URL filtering
set profiles custom-url-category questionable-adult type "Category Match" list [ adult questionable ]
set profiles url-filtering Outbound-URL block [ questionable-adult extremism ]

#enable the tab-complete again
exit
set cli scripting-mode off
